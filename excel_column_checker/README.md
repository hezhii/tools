# Excel Column Checker

一个高性能的 Rust 命令行工具，用于检测 Excel 文件中未被系统识别的列名。

## 功能特性

- 🚀 高性能：使用 Rust 编写，处理速度快
- 📊 支持多种 Excel 格式：`.xlsx`、`.xls`、`.xlsm`
- 🔍 递归扫描：自动扫描指定目录及其子目录下的所有 Excel 文件
- 🎨 彩色输出：使用彩色终端输出，易于阅读
- 📝 详细模式：可选的详细输出模式，显示每个文件的未识别列名
- ✅ 完整报告：汇总所有未识别的列名

## 安装

### 方法 1: 从源码构建（推荐）

确保已安装 Rust 和 Cargo（推荐使用 [rustup](https://rustup.rs/)）

```bash
# 克隆或进入项目目录
cd excel_column_checker

# 构建发布版本
cargo build --release

# 可执行文件位于 target/release/excel_column_checker
```

### 方法 2: 直接运行

如果只想临时使用，可以用 `cargo run` 命令：

```bash
cargo run --release -- --input /path/to/excel/folder
```

## 使用方法

### 基本用法

```bash
# 使用编译后的可执行文件
./target/release/excel_column_checker --input /path/to/excel/folder

# 或者添加到 PATH 后直接使用
excel_column_checker --input /path/to/excel/folder
```

### 详细输出模式

使用 `-v` 或 `--verbose` 参数启用详细输出，显示每个文件中发现的具体列名：

```bash
excel_column_checker --input /path/to/excel/folder --verbose
```

### 查看帮助信息

```bash
excel_column_checker --help
```

输出示例：
```
检测 Excel 文件中未被系统识别的列名

Usage: excel_column_checker --input <INPUT>

Options:
  -i, --input <INPUT>  输入目录路径
  -v, --verbose        是否显示详细输出
  -h, --help           Print help
  -V, --version        Print version
```

## 使用示例

### 示例 1: 基本检测

```bash
$ excel_column_checker --input ./data

================================================================================
检测未被系统识别的列名
================================================================================

✓ 找到 3 个 Excel 文件

[1/3] 处理: file1.xlsx
  → 发现 2 个未识别列名
[2/3] 处理: file2.xlsx
  → 所有列名均已识别
[3/3] 处理: subfolder/file3.xlsx
  → 发现 1 个未识别列名

================================================================================
汇总结果
================================================================================

共发现 3 个未被系统识别的列名:

  • 自定义字段1
  • 自定义字段2
  • 备注信息

================================================================================
```

### 示例 2: 详细输出模式

```bash
$ excel_column_checker --input ./data --verbose

================================================================================
检测未被系统识别的列名
================================================================================

✓ 找到 3 个 Excel 文件

[1/3] 处理: file1.xlsx
  → 发现 2 个未识别列名: 自定义字段1, 自定义字段2
[2/3] 处理: file2.xlsx
  → 所有列名均已识别
[3/3] 处理: subfolder/file3.xlsx
  → 发现 1 个未识别列名: 备注信息

================================================================================
汇总结果
================================================================================

共发现 3 个未被系统识别的列名:

  • 自定义字段1
  • 自定义字段2
  • 备注信息

详细信息:

  file1.xlsx
    - 自定义字段1
    - 自定义字段2

  subfolder/file3.xlsx
    - 备注信息

================================================================================
```

## 系统识别的列名

工具内置了以下系统列名的识别规则（部分列表）：

- 标题、申请人、公开(公告)号、摘要、申请号、申请日
- 专利类型、IPC主分类、IPC、CPC
- 发明人、当前权利人、代理机构、代理人
- 引证次数、被引证次数、家族同族信息
- 法律状态、转让信息、许可信息、质押信息
- 更多...（共 190+ 个系统列名）

完整列表请查看源代码中的 `get_system_columns()` 函数。

## 技术栈

- **语言**: Rust
- **依赖库**:
  - `calamine`: Excel 文件读取
  - `walkdir`: 递归目录遍历
  - `clap`: 命令行参数解析
  - `colored`: 彩色终端输出

## 性能特点

- 采用 Rust 开发，编译后的二进制文件执行效率极高
- 内存安全，无需垃圾回收
- 并发友好的架构设计
- 适合处理大量 Excel 文件

## 常见问题

### Q: 支持哪些 Excel 格式？
A: 支持 `.xlsx`、`.xls` 和 `.xlsm` 格式。

### Q: 如何添加新的系统列名？
A: 编辑 `src/main.rs` 文件中的 `get_system_columns()` 函数，在列表中添加新的列名即可。

### Q: 程序报错无法读取某个文件？
A: 可能是文件损坏或格式不标准，程序会跳过该文件并继续处理其他文件。

### Q: 如何让工具在系统任意位置都能使用？
A: 参考 [BUILD.md](BUILD.md) 文档，将编译后的可执行文件添加到系统 PATH。

## 许可证

MIT License

## 贡献

欢迎提交 Issue 和 Pull Request！
